# -*- coding: utf-8 -*-
"""Sales prediction project.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Jc02yTtUE533aw5NmTo9JhXH7mozDBgs
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import StandardScaler

sales=pd.read_csv('/content/advertising.csv')
sales

"""Data Analysis and Visualization"""

sales.shape

sales.info()

sales.describe()

sns.pairplot(sales,x_vars=['TV','Radio','Newspaper'],y_vars=['Sales'],kind='scatter')
plt.show()

sales['TV'].plot.hist(bins=10,xlabel='TV')

sales['Radio'].plot.hist(bins=10,color='orange',xlabel='Radio')

sales['Newspaper'].plot.hist(bins=10,color='green',xlabel='Newspaper')

sns.heatmap(sales.corr(),cmap='coolwarm',annot=True)
plt.show()

"""Splitting and training"""

x=sales.iloc[:,0:1]
y=sales.iloc[:,-1]

x

y

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.5,random_state=42)

"""Linear Regression Model"""

model=LinearRegression()
model.fit(x_train,y_train)

y_pred=model.predict(x_test)
y_pred

"""Model Evaluation"""

from sklearn.metrics import r2_score,mean_squared_error
r2_score(y_test,y_pred)

np.sqrt(mean_squared_error(y_test, y_pred))

plt.scatter(y_test,y_pred)

model.coef_

model.intercept_

"""Sales = 6.908527167232716 + 0.05633478 * TV"""

plt.plot(y_pred)

plt.scatter(x_test, y_test)
plt.plot(x_test,6.908527167232716 + 0.05633478*x_test,'r')
plt.show()

"""The Model is able to predict the sales using the advertising platform dataset."""